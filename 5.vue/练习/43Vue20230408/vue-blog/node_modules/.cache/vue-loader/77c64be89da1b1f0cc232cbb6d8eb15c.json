{"remainingRequest":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\src\\components\\article\\ArticleEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\src\\components\\article\\ArticleEdit.vue","mtime":1679476015744},{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":1678865247956},{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":1678865248335}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgd2FuZ0VkaXRvciBmcm9tICJ3YW5nZWRpdG9yIjsNCmltcG9ydCBzdG9yZSBmcm9tICJzdG9yZSI7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHRpdGxlOiAiIiwNCiAgICAgIGNvbnRlbnQ6ICIiLA0KICAgICAgZWRpdG9yOiBudWxsLA0KICAgICAgY292ZXI6ICIiLA0KICAgICAgY2xhc3NpZnlJZDogIiIsDQogICAgICBjbGFzc2lmeUFycjogW10NCiAgICB9Ow0KICB9LA0KICBhc3luYyBjcmVhdGVkKCkgew0KICAgIGxldCByZXN1bHQgPSBhd2FpdCB0aGlzLiRodHRwKHt0eXBlOiAiY2xhc3NpZnkifSkNCiAgICBjb25zb2xlLmxvZyhyZXN1bHQsInJlc3VsdCBlZGl0Iik7DQogICAgdGhpcy5jbGFzc2lmeUFyciA9IHJlc3VsdC5kYXRhLmRhdGEubGlzdA0KICAgIHRoaXMuY2xhc3NpZnlJZCA9IHRoaXMuY2xhc3NpZnlBcnJbMF0uaWQNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBjbGFzc2lmaWVzKCkgew0KICAgICAgcmV0dXJuIHRoaXMuY2xhc3NpZnlBcnI/Lmxlbmd0aD4wP3RoaXMuY2xhc3NpZnlBcnI6W10NCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgY29uc3QgZWRpdG9yID0gbmV3IHdhbmdFZGl0b3IoIiNjb250ZW50Iik7DQogICAgZWRpdG9yLmNvbmZpZy5vbmNoYW5nZSA9IChuZXdIdG1sKSA9PiB7DQogICAgICB0aGlzLmNvbnRlbnQgPSBuZXdIdG1sOw0KICAgIH07DQogICAgZWRpdG9yLmNvbmZpZy51cGxvYWRJbWdTZXJ2ZXIgPSBwcm9jZXNzLmVudi5WVUVfQVBQX0ZJTEVfVVJMOw0KICAgIGVkaXRvci5jb25maWcudXBsb2FkSW1nTWF4U2l6ZSA9IDIwICogMTAyNCAqIDEwMjQ7DQogICAgZWRpdG9yLmNvbmZpZy51cGxvYWRJbWdBY2NlcHQgPSBbImpwZyIsICJqcGVnIiwgInBuZyIsICJnaWYiLCAiYm1wIl07DQogICAgZWRpdG9yLmNvbmZpZy51cGxvYWRJbWdNYXhMZW5ndGggPSA1OyAvLyDkuIDmrKHmnIDlpJrkuIrkvKAgNSDkuKrlm77niYcNCiAgICBlZGl0b3IuY29uZmlnLnVwbG9hZEZpbGVOYW1lID0gImZpbGUiOw0KICAgIGVkaXRvci5jb25maWcuZm9jdXMgPSBmYWxzZTsNCiAgICBlZGl0b3IuY29uZmlnLnVwbG9hZEltZ0hlYWRlcnMgPSB7DQogICAgICBBdXRob3JpemF0aW9uOiBzdG9yZS5nZXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9GSUxFX0tFWSksDQogICAgfTsNCiAgICBlZGl0b3IuY3JlYXRlKCk7DQogICAgdGhpcy5lZGl0b3IgPSBlZGl0b3I7DQogIH0sDQogIGJlZm9yZURlc3Ryb3koKSB7DQogICAgLy8g6LCD55So6ZSA5q+BIEFQSSDlr7nlvZPliY3nvJbovpHlmajlrp7kvovov5vooYzplIDmr4ENCiAgICB0aGlzLmVkaXRvci5kZXN0cm95KCk7DQogICAgdGhpcy5lZGl0b3IgPSBudWxsOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgcmVzZXQoKSB7DQogICAgICB0aGlzLnRpdGxlID0gIiI7DQogICAgICB0aGlzLmVkaXRvci50eHQuY2xlYXIoKTsNCiAgICB9LA0KICAgIGFzeW5jIHN1Ym1pdEFydGljbGUoKSB7DQogICAgICBsZXQgcmVzdWx0ID0gdGhpcy52YWxpZGF0ZUlucHV0KCk7DQogICAgICBpZiAoIXJlc3VsdCkgew0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICB0cnkgew0KICAgICAgICB0aGlzLmNvdmVyID0gdGhpcy5jb250ZW50Lm1hdGNoKC88aW1nIHNyYz0iKFxTKykiLylbMV07DQogICAgICAgIGNvbnNvbGUubG9nKHRoaXMuY292ZXIsICJjb3ZlciIpOw0KICAgICAgICBjb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidWlkIiksICLlj5Hor7fmsYIgVUlEIik7DQogICAgICAgIGF3YWl0IHRoaXMuJGh0dHAoew0KICAgICAgICAgIHR5cGU6ICJhcnRpY2xlQWRkIiwNCiAgICAgICAgICBkYXRhOiB7DQogICAgICAgICAgICBjb250ZW50OiB0aGlzLmNvbnRlbnQsDQogICAgICAgICAgICB0aXRsZTogdGhpcy50aXRsZSwNCiAgICAgICAgICAgIGF1dGhvcjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oInVpZCIpLA0KICAgICAgICAgICAgY292ZXI6IHRoaXMuY292ZXIsDQogICAgICAgICAgICBjbGFzc2lmeTogdGhpcy5jbGFzc2lmeUlkDQogICAgICAgICAgfSwNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMuJG5vdGlmeS5zdWNjZXNzKHsNCiAgICAgICAgICB0aXRsZTogIuaIkOWKnyIsDQogICAgICAgICAgbWVzc2FnZTogIua3u+WKoOaIkOWKnyIsDQogICAgICAgIH0pOw0KICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiLyIpOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7DQogICAgICB9DQogICAgfSwNCiAgICB2YWxpZGF0ZUlucHV0KCkgew0KICAgICAgaWYgKCF0aGlzLnRpdGxlKSB7DQogICAgICAgIHRoaXMuJG5vdGlmeS5lcnJvcih7DQogICAgICAgICAgdGl0bGU6ICLplJnor68iLA0KICAgICAgICAgIG1lc3NhZ2U6ICLmoIfpopjkuI3og73kuLrnqboiLA0KICAgICAgICB9KTsNCiAgICAgICAgdGhpcy4kcmVmc1sidGl0bGUiXS5mb2N1cygpOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQogICAgICBpZiAoIXRoaXMuY29udGVudCkgew0KICAgICAgICB0aGlzLiRub3RpZnkuZXJyb3Ioew0KICAgICAgICAgIHRpdGxlOiAi6ZSZ6K+vIiwNCiAgICAgICAgICBtZXNzYWdlOiAi5YaF5a655LiN6IO95Li656m6IiwNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["ArticleEdit.vue"],"names":[],"mappings":";AAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ArticleEdit.vue","sourceRoot":"src/components/article","sourcesContent":["<!--\r\n * @Descripttion: \r\n * @version: \r\n * @Author: sueRimn\r\n * @Date: 2023-03-21 16:57:29\r\n * @LastEditors: sueRimn\r\n * @LastEditTime: 2023-03-22 17:05:10\r\n-->\r\n<template>\r\n  <el-card>\r\n    <div class=\"blog-article-edit\">\r\n      <div class=\"block\">\r\n        <span class=\"demonstration\">标题</span>\r\n        <el-input v-model=\"title\" placeholder=\"标题\" ref=\"title\"></el-input>\r\n      </div>\r\n      <div class=\"block\">\r\n        <span class=\"demonstration\">内容</span>\r\n        <div id=\"content\"></div>\r\n      </div>\r\n      <div class=\"blog-article-classify\">\r\n        <div class=\"block\">\r\n        <span class=\"mr8\">分类:</span>\r\n        </div>\r\n        <el-radio-group v-model=\"classifyId\">\r\n          <el-radio-button :label=\"item.id\" v-for=\"(item,idx) in classifies\" :key=\"idx\">{{item.name}}</el-radio-button>\r\n        </el-radio-group>\r\n        \r\n      </div>\r\n      <div class=\"blog-article-edit--btn\">\r\n        <el-button type=\"primary\" @click=\"submitArticle\">提交</el-button>\r\n        <el-button type=\"info\" @click=\"reset\">清空</el-button>\r\n      </div>\r\n    </div>\r\n  </el-card>\r\n</template>\r\n\r\n<script>\r\nimport wangEditor from \"wangeditor\";\r\nimport store from \"store\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      title: \"\",\r\n      content: \"\",\r\n      editor: null,\r\n      cover: \"\",\r\n      classifyId: \"\",\r\n      classifyArr: []\r\n    };\r\n  },\r\n  async created() {\r\n    let result = await this.$http({type: \"classify\"})\r\n    console.log(result,\"result edit\");\r\n    this.classifyArr = result.data.data.list\r\n    this.classifyId = this.classifyArr[0].id\r\n  },\r\n  computed: {\r\n    classifies() {\r\n      return this.classifyArr?.length>0?this.classifyArr:[]\r\n    }\r\n  },\r\n  mounted() {\r\n    const editor = new wangEditor(\"#content\");\r\n    editor.config.onchange = (newHtml) => {\r\n      this.content = newHtml;\r\n    };\r\n    editor.config.uploadImgServer = process.env.VUE_APP_FILE_URL;\r\n    editor.config.uploadImgMaxSize = 20 * 1024 * 1024;\r\n    editor.config.uploadImgAccept = [\"jpg\", \"jpeg\", \"png\", \"gif\", \"bmp\"];\r\n    editor.config.uploadImgMaxLength = 5; // 一次最多上传 5 个图片\r\n    editor.config.uploadFileName = \"file\";\r\n    editor.config.focus = false;\r\n    editor.config.uploadImgHeaders = {\r\n      Authorization: store.get(process.env.VUE_APP_FILE_KEY),\r\n    };\r\n    editor.create();\r\n    this.editor = editor;\r\n  },\r\n  beforeDestroy() {\r\n    // 调用销毁 API 对当前编辑器实例进行销毁\r\n    this.editor.destroy();\r\n    this.editor = null;\r\n  },\r\n  methods: {\r\n    reset() {\r\n      this.title = \"\";\r\n      this.editor.txt.clear();\r\n    },\r\n    async submitArticle() {\r\n      let result = this.validateInput();\r\n      if (!result) {\r\n        return;\r\n      }\r\n      try {\r\n        this.cover = this.content.match(/<img src=\"(\\S+)\"/)[1];\r\n        console.log(this.cover, \"cover\");\r\n        console.log(localStorage.getItem(\"uid\"), \"发请求 UID\");\r\n        await this.$http({\r\n          type: \"articleAdd\",\r\n          data: {\r\n            content: this.content,\r\n            title: this.title,\r\n            author: localStorage.getItem(\"uid\"),\r\n            cover: this.cover,\r\n            classify: this.classifyId\r\n          },\r\n        });\r\n        this.$notify.success({\r\n          title: \"成功\",\r\n          message: \"添加成功\",\r\n        });\r\n        this.$router.push(\"/\");\r\n        return false;\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n    validateInput() {\r\n      if (!this.title) {\r\n        this.$notify.error({\r\n          title: \"错误\",\r\n          message: \"标题不能为空\",\r\n        });\r\n        this.$refs[\"title\"].focus();\r\n        return false;\r\n      }\r\n      if (!this.content) {\r\n        this.$notify.error({\r\n          title: \"错误\",\r\n          message: \"内容不能为空\",\r\n        });\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\">\r\n.blog-article-edit {\r\n  padding: 10px;\r\n  background-color: #fff;\r\n}\r\n\r\n.block {\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  align-items: flex-start;\r\n  margin-bottom: 10px;\r\n  margin-top: 8px;\r\n  text-align: left;\r\n\r\n  & span {\r\n    width: 60px;\r\n    padding-right: 6px;\r\n  }\r\n}\r\n\r\n.blog-article-edit--btn {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  width: 60%;\r\n  margin: 10px auto;\r\n\r\n  & button {\r\n    width: 50%;\r\n  }\r\n}\r\n.blog-article-classify\r\n  display flex\r\n  flex-direction: column\r\n  justify-content: flex-start\r\n  margin-bottom: 16px\r\n</style>"]}]}