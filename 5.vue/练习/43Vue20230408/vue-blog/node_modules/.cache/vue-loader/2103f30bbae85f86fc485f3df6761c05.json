{"remainingRequest":"D:\\gitLocal\\5.vue\\练习\\43Vue20230408\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\gitLocal\\5.vue\\练习\\43Vue20230408\\vue-blog\\src\\components\\Form.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\gitLocal\\5.vue\\练习\\43Vue20230408\\vue-blog\\src\\components\\Form.vue","mtime":1679713488513},{"path":"D:\\gitLocal\\5.vue\\练习\\43Vue20230408\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\gitLocal\\5.vue\\练习\\43Vue20230408\\vue-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":1678865247956},{"path":"D:\\gitLocal\\5.vue\\练习\\43Vue20230408\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\gitLocal\\5.vue\\练习\\43Vue20230408\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":1678865248335}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgZm9ybUlucHV0IGZyb20gIkAvY29uZmlnL2Zvcm1EYXRhcy5qcyI7DQppbXBvcnQgcnVsZXNNYXAgZnJvbSAiQC9jb25maWcvZm9ybVZhbGlkYXRlLmpzIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgcnVsZUZvcm06IHt9LA0KICAgICAgaW1hZ2VVcmw6ICIiLA0KICAgIH07DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgZm9ybUlucHV0cygpIHsNCiAgICAgIHJldHVybiBmb3JtSW5wdXRbdGhpcy50eXBlXTsNCiAgICB9LA0KICAgIHJ1bGVzKCkgew0KICAgICAgcmV0dXJuIHJ1bGVzTWFwW3RoaXMudHlwZV07DQogICAgfSwNCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICB0eXBlOiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLmNsZWFyRm9ybSgpOw0KICAgIH0sDQogIH0sDQogIHByb3BzOiB7DQogICAgdHlwZTogew0KICAgICAgdHlwZTogU3RyaW5nLA0KICAgIH0sDQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgaWYgKHRoaXMuJHJvdXRlLm5hbWUgPT0gIm15SW5mbyIpIHsNCiAgICAgIGNvbnNvbGUubG9nKCLlr7nmlbDmja7ov5vooYzlpITnkIYiKTsNCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybUlucHV0cyk7DQogICAgICBsZXQgc291cmNlRGF0YSA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvOw0KICAgICAgY29uc29sZS5sb2coc291cmNlRGF0YSwgInNvdXJjZSIpOw0KICAgICAgbGV0IGZpbmFsQXJyID0gDQogICAgICAgIE9iamVjdC5lbnRyaWVzKHNvdXJjZURhdGEpLmZpbHRlcigoW2tleV0pID0+IHsNCiAgICAgICAgICByZXR1cm4gKA0KICAgICAgICAgICAgKHRoaXMuZm9ybUlucHV0cy5maW5kKChpdGVtKSA9PiB7DQogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0ZW0ucXVlcnksa2V5LCJ0ZXN0Iik7DQogICAgICAgICAgICAgIHJldHVybiBpdGVtLnF1ZXJ5ID09PSBrZXkNCiAgICAgICAgICAgIH0pIT09IHVuZGVmaW5lZCkgDQogICAgICAgICAgKTsNCiAgICAgICAgfSkNCiAgICAgIDsNCiAgICAgIGNvbnNvbGUubG9nKGZpbmFsQXJyLCJBcnIiKTsNCiAgICAgIGxldCBmaW5hbE9iaiA9IE9iamVjdC5mcm9tRW50cmllcyhmaW5hbEFycikNCiAgICAgIGNvbnNvbGUubG9nKGZpbmFsT2JqLCAiZmluYWxPYmoiKTsNCiAgICAgIHRoaXMucnVsZUZvcm0gPSBmaW5hbE9iag0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnR5cGUsIm1vdW50ZWQiKTsNCiAgfSwNCg0KICBtZXRob2RzOiB7DQogICAgY2xlYXJGb3JtKCkgew0KICAgICAgdGhpcy4kcmVmc1siZWxGb3JtIl0ucmVzZXRGaWVsZHMoKTsNCiAgICB9LA0KICAgIGhhbmRsZUF2YXRhclN1Y2Nlc3MocmVzKSB7DQogICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7DQogICAgICB0aGlzLnJ1bGVGb3JtLmF2YXRhciA9IHJlcy5kYXRhDQogICAgICAvLyB0aGlzLmltYWdlVXJsID0gcmVzLmRhdGE7DQogICAgICAvLyB0aGlzLmltYWdlVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlLnJhdyk7DQogICAgfSwNCiAgICBiZWZvcmVBdmF0YXJVcGxvYWQoZmlsZSkgew0KICAgICAgY29uc29sZS5sb2coZmlsZSk7DQogICAgICBpZiAoZmlsZS5zaXplID4gMjAgKiAxMDI0ICogMTAyNCkgew0KICAgICAgICB0aGlzLiRub3RpZnkoew0KICAgICAgICAgIHRpdGxlOiAn6K2m5ZGKJywNCiAgICAgICAgICBtZXNzYWdlOiAn5paH5Lu26L+H5aSnJywNCiAgICAgICAgICB0eXBlOiAnd2FybmluZycNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgfQ0KICAgICAgaWYgKCEvaW1hZ2UvLnRlc3QoZmlsZS50eXBlKSkgew0KICAgICAgICBjb25zb2xlLmxvZygidHlwZSBmaWxlIik7DQogICAgICAgIHRoaXMuJG5vdGlmeSh7DQogICAgICAgICAgdGl0bGU6ICforablkYonLA0KICAgICAgICAgIG1lc3NhZ2U6ICfmlofku7bnsbvlnovkuI3lr7knLA0KICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICB9DQogICAgICByZXR1cm4gdHJ1ZQ0KICAgICAgLy8gY29uc3QgaXNKUEcgPSBmaWxlLnR5cGUgPT09ICJpbWFnZS9qcGVnIjsNCiAgICAgIC8vIGNvbnN0IGlzTHQyTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMjsNCg0KICAgICAgLy8gaWYgKCFpc0pQRykgew0KICAgICAgLy8gICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuIrkvKDlpLTlg4/lm77niYflj6rog73mmK8gSlBHIOagvOW8jyEiKTsNCiAgICAgIC8vIH0NCiAgICAgIC8vIGlmICghaXNMdDJNKSB7DQogICAgICAvLyAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuS4iuS8oOWktOWDj+WbvueJh+Wkp+Wwj+S4jeiDvei2hei/hyAyTUIhIik7DQogICAgICAvLyB9DQogICAgICAvLyByZXR1cm4gaXNKUEcgJiYgaXNMdDJNOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["Form.vue"],"names":[],"mappings":";AA+CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Form.vue","sourceRoot":"src/components","sourcesContent":["<!--\r\n * @Descripttion: \r\n * @version: \r\n * @Author: sueRimn\r\n * @Date: 2023-03-16 16:53:49\r\n * @LastEditors: sueRimn\r\n * @LastEditTime: 2023-03-25 11:03:45\r\n-->\r\n<template>\r\n  <div>\r\n    <el-form ref=\"elForm\" :model=\"ruleForm\" label-width=\"90px\" :rules=\"rules\">\r\n      <el-form-item\r\n        :label=\"item.label\"\r\n        v-for=\"item in formInputs\"\r\n        :key=\"item.query\"\r\n        :prop=\"item.query\"\r\n        :roles=\"rules[item?.query]\"\r\n      >\r\n        <el-upload\r\n          v-if=\"item.type === 'avatar'\"\r\n          class=\"avatar-uploader\"\r\n          action=\"http://127.0.0.1:3000/upload/user\"\r\n          :show-file-list=\"false\"\r\n          :on-success=\"handleAvatarSuccess\"\r\n          :before-upload=\"beforeAvatarUpload\"\r\n          :headers=\"{ Authorization: `Bearer ${$store.state.token}` }\"\r\n          \r\n        >\r\n          <el-image\r\n            v-if=\"ruleForm[item?.query]\" :src=\"ruleForm[item?.query]\" class=\"avatar\"\r\n            style=\"width: 50px; height: 50px\"\r\n            fit=\"fit\"\r\n          ></el-image>\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n        </el-upload>\r\n        <el-input\r\n          v-model=\"ruleForm[item?.query]\"\r\n          :readonly=\"item.readOnly\"\r\n          :type=\"item.type\"\r\n          v-else\r\n        ></el-input>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport formInput from \"@/config/formDatas.js\";\r\nimport rulesMap from \"@/config/formValidate.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      ruleForm: {},\r\n      imageUrl: \"\",\r\n    };\r\n  },\r\n  computed: {\r\n    formInputs() {\r\n      return formInput[this.type];\r\n    },\r\n    rules() {\r\n      return rulesMap[this.type];\r\n    },\r\n  },\r\n  watch: {\r\n    type: function () {\r\n      this.clearForm();\r\n    },\r\n  },\r\n  props: {\r\n    type: {\r\n      type: String,\r\n    },\r\n  },\r\n  created() {\r\n    if (this.$route.name == \"myInfo\") {\r\n      console.log(\"对数据进行处理\");\r\n      console.log(this.formInputs);\r\n      let sourceData = this.$store.state.userInfo;\r\n      console.log(sourceData, \"source\");\r\n      let finalArr = \r\n        Object.entries(sourceData).filter(([key]) => {\r\n          return (\r\n            (this.formInputs.find((item) => {\r\n              console.log(item.query,key,\"test\");\r\n              return item.query === key\r\n            })!== undefined) \r\n          );\r\n        })\r\n      ;\r\n      console.log(finalArr,\"Arr\");\r\n      let finalObj = Object.fromEntries(finalArr)\r\n      console.log(finalObj, \"finalObj\");\r\n      this.ruleForm = finalObj\r\n    }\r\n  },\r\n  mounted() {\r\n    // console.log(this.type,\"mounted\");\r\n  },\r\n\r\n  methods: {\r\n    clearForm() {\r\n      this.$refs[\"elForm\"].resetFields();\r\n    },\r\n    handleAvatarSuccess(res) {\r\n      console.log(res.data);\r\n      this.ruleForm.avatar = res.data\r\n      // this.imageUrl = res.data;\r\n      // this.imageUrl = URL.createObjectURL(file.raw);\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      console.log(file);\r\n      if (file.size > 20 * 1024 * 1024) {\r\n        this.$notify({\r\n          title: '警告',\r\n          message: '文件过大',\r\n          type: 'warning'\r\n        });\r\n        return false\r\n      }\r\n      if (!/image/.test(file.type)) {\r\n        console.log(\"type file\");\r\n        this.$notify({\r\n          title: '警告',\r\n          message: '文件类型不对',\r\n          type: 'warning'\r\n        });\r\n        return false\r\n      }\r\n      return true\r\n      // const isJPG = file.type === \"image/jpeg\";\r\n      // const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      // if (!isJPG) {\r\n      //   this.$message.error(\"上传头像图片只能是 JPG 格式!\");\r\n      // }\r\n      // if (!isLt2M) {\r\n      //   this.$message.error(\"上传头像图片大小不能超过 2MB!\");\r\n      // }\r\n      // return isJPG && isLt2M;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>"]}]}