{"remainingRequest":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\src\\views\\Wechat.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\src\\views\\Wechat.vue","mtime":1680085202752},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":1678865247956},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":1678865248335}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgVnVlIGZyb20gInZ1ZSI7DQppbXBvcnQgeyBpbyB9IGZyb20gInNvY2tldC5pby1jbGllbnQiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBjb250ZW50OiAiIiwNCiAgICAgIGluZm9MaXN0OiBbXSwNCiAgICAgIHNvY2tldDogbnVsbCwNCiAgICAgIG5pY2tOYW1lOiAiIiwNCiAgICAgIGlzTmFtZTogZmFsc2UsDQogICAgICBuYW1lQ29udGVudDogIiIsDQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLiRzdG9yZS5zdGF0ZS5kaXJlY3Rpb24gPSAicmlnaHQiDQogICAgbGV0IHNvY2tldCA9IGlvKCJ3czovLzEyNy4wLjAuMTo4ODg4IiwgeyB0cmFuc3BvcnRzOiBbIndlYnNvY2tldCJdIH0pOw0KICAgIGNvbnNvbGUubG9nKHNvY2tldCwic29ja2V0Iik7DQogICAgdGhpcy5zb2NrZXQgPSBzb2NrZXQ7DQogICAgbGV0IG5hbWUgPSB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mbz8ubmlja25hbWU7DQogICAgY29uc29sZS5sb2cobmFtZSwgIm5hbWUgeHh4eCIpOw0KICAgIG5hbWUgPyAodGhpcy5uaWNrTmFtZSA9IG5hbWUpIDogKHRoaXMubmlja05hbWUgPSAiIik7DQogICAgbmFtZSA/ICh0aGlzLmlzTmFtZSA9IHRydWUpIDogKHRoaXMuaXNOYW1lID0gZmFsc2UpOw0KICAgIGlmIChuYW1lKSB7DQogICAgICB0aGlzLnNvY2tldC5lbWl0KCJsb2dpbiIsIHsgbmlja25hbWU6IG5hbWUsdHlwZTogImFjdGlvbiIgfSk7DQogICAgfQ0KICAgIHNvY2tldC5vbigiY29ubmVjdCIsICgpID0+IHsNCiAgICAgIGNvbnNvbGUubG9nKCJzb2NrZXQiLCAi5a6i5oi356uv6L+e5o6l5bu656uLIik7DQogICAgICBzb2NrZXQub24oImVudGVyIiwgKG9iaikgPT4gew0KICAgICAgICBpZiAob2JqLmVycm9yKSB7DQogICAgICAgICAgVnVlLnByb3RvdHlwZS4kbm90aWZ5KHsNCiAgICAgICAgICAgIHRpdGxlOiAi6K2m5ZGKIiwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICLmmLXnp7Dph43lpI0iLA0KICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLA0KICAgICAgICAgIH0pOw0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAob2JqLnVzZXIgPT09ICJtZSIpIHsNCiAgICAgICAgICB0aGlzLmlzTmFtZSA9IHRydWU7DQogICAgICAgICAgdGhpcy5uaWNrTmFtZSA9IG9iai5uaWNrbmFtZTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBjb25zb2xlLmxvZyhvYmosICJlbnRlciIpOw0KICAgICAgICB0aGlzLmluZm9MaXN0LnB1c2gob2JqKTsNCiAgICAgIH0pOw0KICAgICAgc29ja2V0Lm9uKCJsZWF2ZSIsIChvYmopID0+IHsNCiAgICAgICAgdGhpcy5pbmZvTGlzdC5wdXNoKG9iaik7DQogICAgICAgIGNvbnNvbGUubG9nKG9iaiwgImxlYXZlIik7DQogICAgICB9KTsNCiAgICAgIHNvY2tldC5vbigicmVjZWl2ZSIsIChvYmopID0+IHsNCiAgICAgICAgdGhpcy5pbmZvTGlzdC5wdXNoKG9iaik7DQogICAgICAgIGNvbnNvbGUubG9nKG9iaiwgIm9iaiIpOw0KICAgICAgfSk7DQogICAgfSk7DQoNCiAgfSwNCiAgYmVmb3JlRGVzdHJveSgpIHsNCiAgICB0aGlzLnNvY2tldC5jbG9zZSgpOw0KICB9LA0KDQogIG1vdW50ZWQoKSB7fSwNCg0KICBtZXRob2RzOiB7DQogICAgc2VuZCgpIHsNCiAgICAgIHRoaXMuc29ja2V0LmVtaXQoImNoYXQiLCB7IG1zZzogdGhpcy5jb250ZW50LCBuaWNrbmFtZTogdGhpcy5uaWNrTmFtZSB9KTsNCiAgICAgIHRoaXMuY29udGVudCA9ICIiDQogICAgfSwNCiAgICBzdWJtaXROYW1lKCkgew0KICAgICAgdGhpcy5zb2NrZXQuZW1pdCgibG9naW4iLCB7IG5pY2tuYW1lOiB0aGlzLm5hbWVDb250ZW50IH0pOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["Wechat.vue"],"names":[],"mappings":";AAkCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Wechat.vue","sourceRoot":"src/views","sourcesContent":["<!--\r\n * @Descripttion: \r\n * @version: \r\n * @Author: sueRimn\r\n * @Date: 2023-03-28 16:09:45\r\n * @LastEditors: sueRimn\r\n * @LastEditTime: 2023-03-29 18:16:34\r\n-->\r\n<template>\r\n  <div class=\"blog-room--wrap\">\r\n    <div class=\"blog-room--content\">\r\n      <div class=\"blog-room--info\"  v-for=\"(item, idx) in infoList\" :key=\"idx\">\r\n        <div class=\"blog-room--info--wrap\" :class=\"item.type\">\r\n          <span class=\"userClass\">{{ item?.type === \"action\" ?  \"\" : item?.nickname }}</span>\r\n          <p>{{ item?.msg }}</p>\r\n          <span>{{ item?.time }}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"blog-room--input\">\r\n      <el-input v-model=\"content\" placeholder=\"请输入内容\"></el-input>\r\n      <el-button type=\"primary\" @click=\"send\">发送</el-button>\r\n    </div>\r\n    <!--  -->\r\n    <el-dialog title=\"注册昵称\" :visible=\"!isName\" width=\"30%\">\r\n      <el-input v-model=\"nameContent\" placeholder=\"昵称\"></el-input>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"submitName\">提交</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from \"vue\";\r\nimport { io } from \"socket.io-client\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      content: \"\",\r\n      infoList: [],\r\n      socket: null,\r\n      nickName: \"\",\r\n      isName: false,\r\n      nameContent: \"\",\r\n    };\r\n  },\r\n  created() {\r\n    this.$store.state.direction = \"right\"\r\n    let socket = io(\"ws://127.0.0.1:8888\", { transports: [\"websocket\"] });\r\n    console.log(socket,\"socket\");\r\n    this.socket = socket;\r\n    let name = this.$store.state.userInfo?.nickname;\r\n    console.log(name, \"name xxxx\");\r\n    name ? (this.nickName = name) : (this.nickName = \"\");\r\n    name ? (this.isName = true) : (this.isName = false);\r\n    if (name) {\r\n      this.socket.emit(\"login\", { nickname: name,type: \"action\" });\r\n    }\r\n    socket.on(\"connect\", () => {\r\n      console.log(\"socket\", \"客户端连接建立\");\r\n      socket.on(\"enter\", (obj) => {\r\n        if (obj.error) {\r\n          Vue.prototype.$notify({\r\n            title: \"警告\",\r\n            message: \"昵称重复\",\r\n            type: \"warning\",\r\n          });\r\n          return;\r\n        }\r\n        if (obj.user === \"me\") {\r\n          this.isName = true;\r\n          this.nickName = obj.nickname;\r\n        }\r\n        // console.log(obj, \"enter\");\r\n        this.infoList.push(obj);\r\n      });\r\n      socket.on(\"leave\", (obj) => {\r\n        this.infoList.push(obj);\r\n        console.log(obj, \"leave\");\r\n      });\r\n      socket.on(\"receive\", (obj) => {\r\n        this.infoList.push(obj);\r\n        console.log(obj, \"obj\");\r\n      });\r\n    });\r\n\r\n  },\r\n  beforeDestroy() {\r\n    this.socket.close();\r\n  },\r\n\r\n  mounted() {},\r\n\r\n  methods: {\r\n    send() {\r\n      this.socket.emit(\"chat\", { msg: this.content, nickname: this.nickName });\r\n      this.content = \"\"\r\n    },\r\n    submitName() {\r\n      this.socket.emit(\"login\", { nickname: this.nameContent });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n  .blog-room--content {\r\n    display: flex\r\n    flex-direction: column\r\n    justify-content: space-around\r\n  }\r\n  .blog-room--info--wrap\r\n    display: flex\r\n    justify-content: center\r\n    align-items: center\r\n    & *\r\n      margin 2px 6px\r\n  .blog-room--info--wrap.left\r\n    align-items: center\r\n    justify-content: flex-start\r\n  .blog-room--info--wrap.right\r\n    flex-direction: row-reverse\r\n    justify-content: flex-start\r\n    align-items: center\r\n  .userClass\r\n    color: #fff\r\n    font-size 20px\r\n</style>\r\n"]}]}