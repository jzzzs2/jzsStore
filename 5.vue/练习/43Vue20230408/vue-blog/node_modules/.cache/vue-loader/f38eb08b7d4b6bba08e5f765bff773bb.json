{"remainingRequest":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\src\\mobviews\\MUser.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\src\\mobviews\\MUser.vue","mtime":1680953022130},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":1678865247956},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":1678865248335}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgc3RvcmUgZnJvbSAic3RvcmUiDQpjb25zdCB0aXBzTWFwID0gew0KICBsb2dpbjogIui/mOayoeazqOWGjD/ngrnmiJHms6jlhowiLA0KICByZWdpc3RlcjogIuW3sue7j+azqOWGjD/ngrnmiJHnmbvlvZUiLA0KICBpbmZvOiAiIg0KfQ0KY29uc3QgYXBpTWFwID0gew0KICBpbmZvOiAiaW5mb01vZGlmeSINCn0NCmNvbnN0IHRpdGxlTWFwID0gew0KICBsb2dpbjogIueZu+W9lSIsDQogIHJlZ2lzdGVyOiAi5rOo5YaMIiwNCiAgaW5mbzogIuS4quS6uuS/oeaBryIsDQp9Ow0KY29uc3QgYnRuTWFwID0gew0KICBsb2dpbjogIueZu+W9lSIsDQogIHJlZ2lzdGVyOiAi5rOo5YaMIiwNCiAgaW5mbzogIuS/ruaUuSIsDQp9Ow0KaW1wb3J0IE1EaWFsb2dGb3JtIGZyb20gIkAvbUNvbXBvbmVudHMvTURpYWxvZ0Zvcm0iOw0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7DQogICAgTURpYWxvZ0Zvcm0sDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGZpbGU6IFtdLA0KICAgICAgbmV3VVJMOiAiIiwNCiAgICAgIHRpcFR5cGU6ICIiLA0KICAgICAgdHlwZTogIiINCiAgICB9Ow0KICB9LA0KICBwcm9wczogew0KICAgIHN0YXRlOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgfSwNCiAgfSwNCiAgbW91bnRlZCgpIHt9LA0KICBtZXRob2RzOiB7DQogICAgY2hhbmdlRm9ybSAoKSB7DQogICAgICAodGhpcy50eXBlIHx8IHRoaXMuc3RhdGUpID09PSAibG9naW4iID8gKHRoaXMudHlwZT0icmVnaXN0ZXIiKSA6ICh0aGlzLnR5cGU9ImxvZ2luIikNCiAgICB9LA0KICAgIGFzeW5jIHN1Ym1pdE1lc3NhZ2UoKSB7DQogICAgICBjb25zb2xlLmxvZyh0aGlzLmZvcm1UeXBlLCAieHh4eCIpOw0KICAgICAgaWYgKHRoaXMuZm9ybVR5cGUgPT09ICJsb2dpbiIgfHwgdGhpcy5mb3JtVHlwZSA9PT0gInJlZ2lzdGVyIikgew0KICAgICAgICBsZXQgZGF0YSA9IHRoaXMuJHJlZnNbImZvcm1XcmFwIl0uZm9ybTsNCiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMuJGh0dHAoeyB0eXBlOiB0aGlzLmZvcm1UeXBlLCBkYXRhOiBkYXRhIH0pOw0KICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQsICJ4eHh4Iik7DQogICAgICAgIGlmIChyZXN1bHQuZGF0YS5kYXRhLnRva2VuKSB7DQogICAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInNldFRva2VuIiwgcmVzdWx0LmRhdGEuZGF0YS50b2tlbik7DQogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICJtQXJ0aWNsZXMifSkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgLy8NCiAgICAgIGlmICh0aGlzLmZvcm1UeXBlID09PSAiaW5mbyIpIHsNCiAgICAgICAgLy/kv67mlLkNCiAgICAgICAgY29uc29sZS5sb2coInhpdSBnYWkiKTsNCiAgICAgICAgbGV0IGRhdGEgPSB0aGlzLiRyZWZzWyJmb3JtV3JhcCJdLmZvcm0NCiAgICAgICAgYXdhaXQgdGhpcy4kaHR0cCh7IHR5cGU6IGFwaU1hcFt0aGlzLmZvcm1UeXBlXSwgZGF0YSB9KTsNCiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInNldFRva2VuIiwgc3RvcmUuZ2V0KCJ0b2tlbiIpKTsNCiAgICAgICAgLy8gbGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMuJGh0dHAoeyB0eXBlOiAiaW5mbyIsIGRhdGEgfSk7DQogICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3VsdDIsIjIyMjIyIik7DQogICAgICAgIC8vDQogICAgICB9DQogICAgfSwNCiAgICBhc3luYyBhZnRlclJlYWQoZmlsZSkgew0KICAgICAgLy8gY29uc29sZS5sb2coZmlsZSwiIix0aGlzLmZpbGUpOw0KICAgICAgdGhpcy5uZXdVUkwgPSBmaWxlLmNvbnRlbnQ7DQogICAgICB0cnkgew0KICAgICAgICBsZXQgZGF0YSA9IG5ldyBGb3JtRGF0YSgpOw0KICAgICAgICBkYXRhLmFwcGVuZCgiZmlsZSIsIGZpbGUuZmlsZSk7DQogICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCB0aGlzLiRodHRwKHsgdHlwZTogInBob3RvIiwgZGF0YSB9KTsNCiAgICAgICAgLy8gY29uc29sZS5sb2cocmVzdWx0LCAicmVzdWx0IHBob3RvIik7DQogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJzZXRUb2tlbiIsIHN0b3JlLmdldCgidG9rZW4iKSk7DQogICAgICAgIA0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOw0KICAgICAgfQ0KICAgIH0sDQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgdGlwcygpIHsNCiAgICAgIHJldHVybiB0aXBzTWFwW3RoaXMudHlwZSB8fCB0aGlzLmZvcm1UeXBlXQ0KICAgIH0sDQogICAgZm9ybVR5cGUoKSB7DQogICAgICByZXR1cm4gdGhpcy50eXBlIHx8IHRoaXMuc3RhdGUgPyB0aGlzLnR5cGUgfHwgdGhpcy5zdGF0ZSA6ICJpbmZvIjsNCiAgICB9LA0KICAgIHRpdGxlKCkgew0KICAgICAgcmV0dXJuIHRpdGxlTWFwW3RoaXMudHlwZSB8fCB0aGlzLmZvcm1UeXBlXTsNCiAgICB9LA0KICAgIGJ0bk5hbWUoKSB7DQogICAgICByZXR1cm4gYnRuTWFwW3RoaXMudHlwZSB8fCB0aGlzLmZvcm1UeXBlXTsNCiAgICB9LA0KICAgIHNyYygpIHsNCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mby5hdmF0YXINCiAgICAgICAgPyB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mby5hdmF0YXINCiAgICAgICAgOiAiaHR0cHM6Ly9mYXN0bHkuanNkZWxpdnIubmV0L25wbS9AdmFudC9hc3NldHMvY2F0LmpwZWciOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["MUser.vue"],"names":[],"mappings":";AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MUser.vue","sourceRoot":"src/mobviews","sourcesContent":["<!--\r\n * @Descripttion: \r\n * @version: \r\n * @Author: sueRimn\r\n * @Date: 2023-04-01 14:53:05\r\n * @LastEditors: sueRimn\r\n * @LastEditTime: 2023-04-08 19:23:42\r\n-->\r\n<template>\r\n  <div class=\"mblog-userInfo--wrap\">\r\n    <h2 class=\"mblog-userInfo--title\">{{ title }}</h2>\r\n    <div v-if=\"formType === 'info'\">\r\n      <van-uploader\r\n        v-model=\"file\"\r\n        :preview-image=\"false\"\r\n        :after-read=\"afterRead\"\r\n      >\r\n        <template>\r\n          <van-image\r\n            round\r\n            width=\"100\"\r\n            height=\"100\"\r\n            :src=\"newURL ? newURL : src\"\r\n          />\r\n        </template>\r\n      </van-uploader>\r\n    </div>\r\n    <div v-else>\r\n      <van-image\r\n        width=\"100\"\r\n        height=\"100\"\r\n        src=\"https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg\"\r\n      />\r\n    </div>\r\n    <MDialogForm :type=\"formType\" ref=\"formWrap\" />\r\n    <p @click=\"changeForm\">{{tips}}</p>\r\n    <van-button type=\"primary\" @click=\"submitMessage\">{{ btnName }}</van-button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport store from \"store\"\r\nconst tipsMap = {\r\n  login: \"还没注册?点我注册\",\r\n  register: \"已经注册?点我登录\",\r\n  info: \"\"\r\n}\r\nconst apiMap = {\r\n  info: \"infoModify\"\r\n}\r\nconst titleMap = {\r\n  login: \"登录\",\r\n  register: \"注册\",\r\n  info: \"个人信息\",\r\n};\r\nconst btnMap = {\r\n  login: \"登录\",\r\n  register: \"注册\",\r\n  info: \"修改\",\r\n};\r\nimport MDialogForm from \"@/mComponents/MDialogForm\";\r\nexport default {\r\n  components: {\r\n    MDialogForm,\r\n  },\r\n  data() {\r\n    return {\r\n      file: [],\r\n      newURL: \"\",\r\n      tipType: \"\",\r\n      type: \"\"\r\n    };\r\n  },\r\n  props: {\r\n    state: {\r\n      type: String,\r\n    },\r\n  },\r\n  mounted() {},\r\n  methods: {\r\n    changeForm () {\r\n      (this.type || this.state) === \"login\" ? (this.type=\"register\") : (this.type=\"login\")\r\n    },\r\n    async submitMessage() {\r\n      console.log(this.formType, \"xxxx\");\r\n      if (this.formType === \"login\" || this.formType === \"register\") {\r\n        let data = this.$refs[\"formWrap\"].form;\r\n        let result = await this.$http({ type: this.formType, data: data });\r\n        console.log(result, \"xxxx\");\r\n        if (result.data.data.token) {\r\n          await this.$store.dispatch(\"setToken\", result.data.data.token);\r\n          this.$router.push({name: \"mArticles\"})\r\n        }\r\n      }\r\n      //\r\n      if (this.formType === \"info\") {\r\n        //修改\r\n        console.log(\"xiu gai\");\r\n        let data = this.$refs[\"formWrap\"].form\r\n        await this.$http({ type: apiMap[this.formType], data });\r\n        this.$store.dispatch(\"setToken\", store.get(\"token\"));\r\n        // let result = await this.$http({ type: \"info\", data });\r\n        // console.log(result2,\"22222\");\r\n        //\r\n      }\r\n    },\r\n    async afterRead(file) {\r\n      // console.log(file,\"\",this.file);\r\n      this.newURL = file.content;\r\n      try {\r\n        let data = new FormData();\r\n        data.append(\"file\", file.file);\r\n        let result = await this.$http({ type: \"photo\", data });\r\n        // console.log(result, \"result photo\");\r\n        this.$store.dispatch(\"setToken\", store.get(\"token\"));\r\n        \r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    tips() {\r\n      return tipsMap[this.type || this.formType]\r\n    },\r\n    formType() {\r\n      return this.type || this.state ? this.type || this.state : \"info\";\r\n    },\r\n    title() {\r\n      return titleMap[this.type || this.formType];\r\n    },\r\n    btnName() {\r\n      return btnMap[this.type || this.formType];\r\n    },\r\n    src() {\r\n      return this.$store.state.userInfo.avatar\r\n        ? this.$store.state.userInfo.avatar\r\n        : \"https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\" >\r\n.mblog-userInfo--wrap {\r\n  height: calc(100vh - 110px);\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-around;\r\n  align-items: center;\r\n}\r\n\r\n.mblog-userInfo--title {\r\n  width: 30%;\r\n  background-color: #fff;\r\n  padding: 4px 10px;\r\n}\r\n</style>"]}]}