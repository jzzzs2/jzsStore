{"remainingRequest":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\src\\mobviews\\MUser.vue?vue&type=style&index=0&id=9a065d4e&prod&lang=stylus&","dependencies":[{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\src\\mobviews\\MUser.vue","mtime":1680953022130},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678865247387},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1678865249033},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\postcss-loader\\src\\index.js","mtime":1678865247954},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\stylus-loader\\index.js","mtime":1678866957323},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\37Vue20230331\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":1678865248335}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoubWJsb2ctdXNlckluZm8tLXdyYXAgew0KICBoZWlnaHQ6IGNhbGMoMTAwdmggLSAxMTBweCk7DQogIGRpc3BsYXk6IGZsZXg7DQogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogIGp1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kOw0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQoubWJsb2ctdXNlckluZm8tLXRpdGxlIHsNCiAgd2lkdGg6IDMwJTsNCiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsNCiAgcGFkZGluZzogNHB4IDEwcHg7DQp9DQo="},{"version":3,"sources":["MUser.vue"],"names":[],"mappings":";AAgJA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"MUser.vue","sourceRoot":"src/mobviews","sourcesContent":["<!--\r\n * @Descripttion: \r\n * @version: \r\n * @Author: sueRimn\r\n * @Date: 2023-04-01 14:53:05\r\n * @LastEditors: sueRimn\r\n * @LastEditTime: 2023-04-08 19:23:42\r\n-->\r\n<template>\r\n  <div class=\"mblog-userInfo--wrap\">\r\n    <h2 class=\"mblog-userInfo--title\">{{ title }}</h2>\r\n    <div v-if=\"formType === 'info'\">\r\n      <van-uploader\r\n        v-model=\"file\"\r\n        :preview-image=\"false\"\r\n        :after-read=\"afterRead\"\r\n      >\r\n        <template>\r\n          <van-image\r\n            round\r\n            width=\"100\"\r\n            height=\"100\"\r\n            :src=\"newURL ? newURL : src\"\r\n          />\r\n        </template>\r\n      </van-uploader>\r\n    </div>\r\n    <div v-else>\r\n      <van-image\r\n        width=\"100\"\r\n        height=\"100\"\r\n        src=\"https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg\"\r\n      />\r\n    </div>\r\n    <MDialogForm :type=\"formType\" ref=\"formWrap\" />\r\n    <p @click=\"changeForm\">{{tips}}</p>\r\n    <van-button type=\"primary\" @click=\"submitMessage\">{{ btnName }}</van-button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport store from \"store\"\r\nconst tipsMap = {\r\n  login: \"还没注册?点我注册\",\r\n  register: \"已经注册?点我登录\",\r\n  info: \"\"\r\n}\r\nconst apiMap = {\r\n  info: \"infoModify\"\r\n}\r\nconst titleMap = {\r\n  login: \"登录\",\r\n  register: \"注册\",\r\n  info: \"个人信息\",\r\n};\r\nconst btnMap = {\r\n  login: \"登录\",\r\n  register: \"注册\",\r\n  info: \"修改\",\r\n};\r\nimport MDialogForm from \"@/mComponents/MDialogForm\";\r\nexport default {\r\n  components: {\r\n    MDialogForm,\r\n  },\r\n  data() {\r\n    return {\r\n      file: [],\r\n      newURL: \"\",\r\n      tipType: \"\",\r\n      type: \"\"\r\n    };\r\n  },\r\n  props: {\r\n    state: {\r\n      type: String,\r\n    },\r\n  },\r\n  mounted() {},\r\n  methods: {\r\n    changeForm () {\r\n      (this.type || this.state) === \"login\" ? (this.type=\"register\") : (this.type=\"login\")\r\n    },\r\n    async submitMessage() {\r\n      console.log(this.formType, \"xxxx\");\r\n      if (this.formType === \"login\" || this.formType === \"register\") {\r\n        let data = this.$refs[\"formWrap\"].form;\r\n        let result = await this.$http({ type: this.formType, data: data });\r\n        console.log(result, \"xxxx\");\r\n        if (result.data.data.token) {\r\n          await this.$store.dispatch(\"setToken\", result.data.data.token);\r\n          this.$router.push({name: \"mArticles\"})\r\n        }\r\n      }\r\n      //\r\n      if (this.formType === \"info\") {\r\n        //修改\r\n        console.log(\"xiu gai\");\r\n        let data = this.$refs[\"formWrap\"].form\r\n        await this.$http({ type: apiMap[this.formType], data });\r\n        this.$store.dispatch(\"setToken\", store.get(\"token\"));\r\n        // let result = await this.$http({ type: \"info\", data });\r\n        // console.log(result2,\"22222\");\r\n        //\r\n      }\r\n    },\r\n    async afterRead(file) {\r\n      // console.log(file,\"\",this.file);\r\n      this.newURL = file.content;\r\n      try {\r\n        let data = new FormData();\r\n        data.append(\"file\", file.file);\r\n        let result = await this.$http({ type: \"photo\", data });\r\n        // console.log(result, \"result photo\");\r\n        this.$store.dispatch(\"setToken\", store.get(\"token\"));\r\n        \r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    tips() {\r\n      return tipsMap[this.type || this.formType]\r\n    },\r\n    formType() {\r\n      return this.type || this.state ? this.type || this.state : \"info\";\r\n    },\r\n    title() {\r\n      return titleMap[this.type || this.formType];\r\n    },\r\n    btnName() {\r\n      return btnMap[this.type || this.formType];\r\n    },\r\n    src() {\r\n      return this.$store.state.userInfo.avatar\r\n        ? this.$store.state.userInfo.avatar\r\n        : \"https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\" >\r\n.mblog-userInfo--wrap {\r\n  height: calc(100vh - 110px);\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-around;\r\n  align-items: center;\r\n}\r\n\r\n.mblog-userInfo--title {\r\n  width: 30%;\r\n  background-color: #fff;\r\n  padding: 4px 10px;\r\n}\r\n</style>"]}]}