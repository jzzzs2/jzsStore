{"remainingRequest":"D:\\十字波\\五.vue框架\\练习\\43Vue20230408\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\十字波\\五.vue框架\\练习\\43Vue20230408\\vue-blog\\src\\views\\Wechat.vue?vue&type=style&index=0&id=010a7589&prod&lang=stylus&scoped=true&","dependencies":[{"path":"D:\\十字波\\五.vue框架\\练习\\43Vue20230408\\vue-blog\\src\\views\\Wechat.vue","mtime":1680170090605},{"path":"D:\\十字波\\五.vue框架\\练习\\43Vue20230408\\vue-blog\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678865247387},{"path":"D:\\十字波\\五.vue框架\\练习\\43Vue20230408\\vue-blog\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1678865249033},{"path":"D:\\十字波\\五.vue框架\\练习\\43Vue20230408\\vue-blog\\node_modules\\postcss-loader\\src\\index.js","mtime":1678865247954},{"path":"D:\\十字波\\五.vue框架\\练习\\43Vue20230408\\vue-blog\\node_modules\\stylus-loader\\index.js","mtime":1678866957323},{"path":"D:\\十字波\\五.vue框架\\练习\\43Vue20230408\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\43Vue20230408\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":1678865248335}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouYmxvZy1yb29tLS13cmFwDQogIC8vIGhlaWdodDogNTB2aA0KDQouYmxvZy1yb29tLS1jb250ZW50IHsNCiAgZGlzcGxheTogZmxleDsNCiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0Ow0KICBoZWlnaHQ6IDYwdmg7DQogIC8vIG92ZXJmbG93LXg6IGhpZGRlbjsNCiAgLy8gb3ZlcmZsb3cteTogYXV0bzsNCiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsNCiAgcGFkZGluZy1ib3R0b206IDQwcHgNCn0NCg0KLmJsb2ctcm9vbS0taW5mbyB7DQogIC8vIGhlaWdodDogNTB2aDsNCiAgbWFyZ2luOiAxMHB4IDBweCA1cHg7DQp9DQoNCi5ibG9nLXJvb20tLWluZm8tLXdyYXAgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCg0KICAmICogew0KICAgIG1hcmdpbjogMnB4IDZweDsNCiAgfQ0KDQogICYgcCB7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBjeWFuOw0KICB9DQp9DQoNCg0KLmJsb2ctcm9vbS0taW5mby0td3JhcC5sZWZ0IHsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0Ow0KDQogICYgcCB7DQogICAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICAgIGJhY2tncm91bmQtY29sb3I6IHBpbms7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsNCiAgfQ0KfQ0KDQouYmxvZy1yb29tLS1pbmZvLS13cmFwLnJpZ2h0IHsNCiAgZmxleC1kaXJlY3Rpb246IHJvdy1yZXZlcnNlOw0KICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQoNCiAgJiBwIHsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogc2t5Ymx1ZTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjOw0KICB9DQp9DQoNCi51c2VyQ2xhc3Mgew0KICB3aWR0aDogNDBweDsNCiAgaGVpZ2h0OiAyMHB4Ow0KICBib3JkZXItcmFkaXVzOiAxMHB4IDZweDsNCiAgY29sb3I6IHBpbms7DQogIGZvbnQtc2l6ZTogMjBweDsNCiAgYmFja2dyb3VuZC1jb2xvcjogI2VlZTsNCn0NCg0KLmZ6MTIgew0KICBmb250LXNpemU6IDEycHg7DQp9DQoNCi5ibG9nLXJvb20tLWlucHV0IHsNCiAgZGlzcGxheTogZmxleDsNCiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KICBtYXJnaW4tdG9wOiAzMHB4DQp9DQoNCi5ibG9nLWluZm8tLW9mZnNldCB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogIGp1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kOw0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KICBib3JkZXItcmFkaXVzOiAyMHB4Ow0KICBib3JkZXI6IDFweCBzb2xpZCBwaW5rOw0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQogIHRvcDogMTJweDsNCiAgcGFkZGluZzogMnB4Ow0KfQ0K"},{"version":3,"sources":["Wechat.vue"],"names":[],"mappings":";AA6IA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Wechat.vue","sourceRoot":"src/views","sourcesContent":["<!--\r\n * @Descripttion: \r\n * @version: \r\n * @Author: sueRimn\r\n * @Date: 2023-03-28 16:09:45\r\n * @LastEditors: sueRimn\r\n * @LastEditTime: 2023-03-30 17:54:50\r\n-->\r\n<template>\r\n  <div class=\"blog-room--wrap\">\r\n    \r\n      <div class=\"blog-room--content\">\r\n        <vuescroll :ops=\"ops\">\r\n        <div class=\"blog-room--info\" v-for=\"(item, idx) in infoList\" :key=\"idx\">\r\n          <div class=\"blog-room--info--wrap\" :class=\"item.type\">\r\n            <span class=\"userClass\" v-if=\"item?.type !== 'action'\">{{\r\n              item?.type === \"action\" ? \"\" : item?.nickname\r\n            }}</span>\r\n            <div :class=\"{ 'blog-info--offset': item?.type !== 'action' }\">\r\n              <p class=\"left\" :class=\"{ mtb20: item?.type === 'action' }\">\r\n                {{ item?.msg }}\r\n              </p>\r\n              <span class=\"fz12\">{{ item?.time }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        </vuescroll>\r\n      </div>\r\n      <div class=\"blog-room--input\">\r\n        <el-input v-model=\"content\" placeholder=\"请输入内容\"></el-input>\r\n        <el-button type=\"primary\" @click=\"send\">发送</el-button>\r\n      </div>\r\n      <!--  -->\r\n      <el-dialog title=\"注册昵称\" :visible=\"!isName\" width=\"30%\">\r\n        <el-input v-model=\"nameContent\" placeholder=\"昵称\"></el-input>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitName\">提交</el-button>\r\n        </span>\r\n        \r\n      </el-dialog>\r\n    \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport vuescroll from \"vuescroll\";\r\nimport Vue from \"vue\";\r\nimport { io } from \"socket.io-client\";\r\nexport default {\r\n  components: {\r\n    vuescroll,\r\n  },\r\n  data() {\r\n    return {\r\n      content: \"\",\r\n      infoList: [],\r\n      socket: null,\r\n      nickName: \"\",\r\n      isName: false,\r\n      nameContent: \"\",\r\n      ops: {\r\n        vuescroll: {},\r\n        scrollPanel: {},\r\n        rail: {\r\n          background: \"#01a99a\",\r\n          opacity: 0,\r\n          size: \"6px\",\r\n          specifyBorderRadius: false,\r\n          gutterOfEnds: null,\r\n          gutterOfSide: \"2px\",\r\n          keepShow: false,\r\n        },\r\n        bar: {},\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    this.$store.state.direction = \"right\";\r\n    let socket = io(process.env[\"VUE_APP_SOCKET_URL\"], {\r\n      transports: [\"websocket\"],\r\n    });\r\n    console.log(socket, \"socket\");\r\n    this.socket = socket;\r\n    let name = this.$store.state.userInfo?.nickname;\r\n    console.log(name, \"name xxxx\");\r\n    name ? (this.nickName = name) : (this.nickName = \"\");\r\n    name ? (this.isName = true) : (this.isName = false);\r\n    if (name) {\r\n      this.socket.emit(\"login\", { nickname: name, type: \"action\" });\r\n    }\r\n    socket.on(\"connect\", () => {\r\n      console.log(\"socket\", \"客户端连接建立\");\r\n      socket.on(\"enter\", (obj) => {\r\n        if (obj.error) {\r\n          Vue.prototype.$notify({\r\n            title: \"警告\",\r\n            message: \"昵称重复\",\r\n            type: \"warning\",\r\n          });\r\n          return;\r\n        }\r\n        if (obj.user === \"me\") {\r\n          this.isName = true;\r\n          this.nickName = obj.nickname;\r\n        }\r\n        // console.log(obj, \"enter\");\r\n        this.infoList.push(obj);\r\n      });\r\n      socket.on(\"leave\", (obj) => {\r\n        this.infoList.push(obj);\r\n        console.log(obj, \"leave\");\r\n      });\r\n      socket.on(\"receive\", (obj) => {\r\n        this.infoList.push(obj);\r\n        console.log(obj, \"obj\");\r\n      });\r\n    });\r\n  },\r\n  beforeDestroy() {\r\n    this.socket.close();\r\n  },\r\n\r\n  mounted() {\r\n    this.$bus.$on(\"clearChatSocket\", this.clearSocket);\r\n  },\r\n  methods: {\r\n    clearSocket() {\r\n      this.socket.close();\r\n    },\r\n    send() {\r\n      this.socket.emit(\"chat\", { msg: this.content, nickname: this.nickName });\r\n      this.content = \"\";\r\n    },\r\n    submitName() {\r\n      this.socket.emit(\"login\", { nickname: this.nameContent });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n.blog-room--wrap\r\n  // height: 50vh\r\n\r\n.blog-room--content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: flex-start;\r\n  height: 60vh;\r\n  // overflow-x: hidden;\r\n  // overflow-y: auto;\r\n  background-color: #fff;\r\n  padding-bottom: 40px\r\n}\r\n\r\n.blog-room--info {\r\n  // height: 50vh;\r\n  margin: 10px 0px 5px;\r\n}\r\n\r\n.blog-room--info--wrap {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  & * {\r\n    margin: 2px 6px;\r\n  }\r\n\r\n  & p {\r\n    border-radius: 6px;\r\n    background-color: #fff;\r\n    border: 1px solid #ccc;\r\n    background-color: cyan;\r\n  }\r\n}\r\n\r\n\r\n.blog-room--info--wrap.left {\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n\r\n  & p {\r\n    border-radius: 6px;\r\n    background-color: pink;\r\n    border: 1px solid #ccc;\r\n  }\r\n}\r\n\r\n.blog-room--info--wrap.right {\r\n  flex-direction: row-reverse;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n\r\n  & p {\r\n    border-radius: 6px;\r\n    background-color: skyblue;\r\n    border: 1px solid #ccc;\r\n  }\r\n}\r\n\r\n.userClass {\r\n  width: 40px;\r\n  height: 20px;\r\n  border-radius: 10px 6px;\r\n  color: pink;\r\n  font-size: 20px;\r\n  background-color: #eee;\r\n}\r\n\r\n.fz12 {\r\n  font-size: 12px;\r\n}\r\n\r\n.blog-room--input {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-top: 30px\r\n}\r\n\r\n.blog-info--offset {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-around;\r\n  align-items: center;\r\n  border-radius: 20px;\r\n  border: 1px solid pink;\r\n  position: relative;\r\n  top: 12px;\r\n  padding: 2px;\r\n}\r\n</style>\r\n"]}]}