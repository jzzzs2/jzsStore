{"remainingRequest":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\src\\views\\Wechat.vue?vue&type=style&index=0&id=ffcaca40&lang=stylus&scoped=true&","dependencies":[{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\src\\views\\Wechat.vue","mtime":1680085202752},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678865247387},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1678865249033},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\postcss-loader\\src\\index.js","mtime":1678865247954},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\stylus-loader\\index.js","mtime":1678866957323},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\32Vue20230325\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":1678865248335}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5ibG9nLXJvb20tLWNvbnRlbnQgewogIGRpc3BsYXk6IGZsZXgKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uCiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQKfQouYmxvZy1yb29tLS1pbmZvLS13cmFwCiAgZGlzcGxheTogZmxleAogIGp1c3RpZnktY29udGVudDogY2VudGVyCiAgYWxpZ24taXRlbXM6IGNlbnRlcgogICYgKgogICAgbWFyZ2luIDJweCA2cHgKLmJsb2ctcm9vbS0taW5mby0td3JhcC5sZWZ0CiAgYWxpZ24taXRlbXM6IGNlbnRlcgogIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydAouYmxvZy1yb29tLS1pbmZvLS13cmFwLnJpZ2h0CiAgZmxleC1kaXJlY3Rpb246IHJvdy1yZXZlcnNlCiAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0CiAgYWxpZ24taXRlbXM6IGNlbnRlcgoudXNlckNsYXNzCiAgY29sb3I6ICNmZmYKICBmb250LXNpemUgMjBweAo="},{"version":3,"sources":["Wechat.vue"],"names":[],"mappings":";AAkIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Wechat.vue","sourceRoot":"src/views","sourcesContent":["<!--\r\n * @Descripttion: \r\n * @version: \r\n * @Author: sueRimn\r\n * @Date: 2023-03-28 16:09:45\r\n * @LastEditors: sueRimn\r\n * @LastEditTime: 2023-03-29 18:16:34\r\n-->\r\n<template>\r\n  <div class=\"blog-room--wrap\">\r\n    <div class=\"blog-room--content\">\r\n      <div class=\"blog-room--info\"  v-for=\"(item, idx) in infoList\" :key=\"idx\">\r\n        <div class=\"blog-room--info--wrap\" :class=\"item.type\">\r\n          <span class=\"userClass\">{{ item?.type === \"action\" ?  \"\" : item?.nickname }}</span>\r\n          <p>{{ item?.msg }}</p>\r\n          <span>{{ item?.time }}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"blog-room--input\">\r\n      <el-input v-model=\"content\" placeholder=\"请输入内容\"></el-input>\r\n      <el-button type=\"primary\" @click=\"send\">发送</el-button>\r\n    </div>\r\n    <!--  -->\r\n    <el-dialog title=\"注册昵称\" :visible=\"!isName\" width=\"30%\">\r\n      <el-input v-model=\"nameContent\" placeholder=\"昵称\"></el-input>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"submitName\">提交</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from \"vue\";\r\nimport { io } from \"socket.io-client\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      content: \"\",\r\n      infoList: [],\r\n      socket: null,\r\n      nickName: \"\",\r\n      isName: false,\r\n      nameContent: \"\",\r\n    };\r\n  },\r\n  created() {\r\n    this.$store.state.direction = \"right\"\r\n    let socket = io(\"ws://127.0.0.1:8888\", { transports: [\"websocket\"] });\r\n    console.log(socket,\"socket\");\r\n    this.socket = socket;\r\n    let name = this.$store.state.userInfo?.nickname;\r\n    console.log(name, \"name xxxx\");\r\n    name ? (this.nickName = name) : (this.nickName = \"\");\r\n    name ? (this.isName = true) : (this.isName = false);\r\n    if (name) {\r\n      this.socket.emit(\"login\", { nickname: name,type: \"action\" });\r\n    }\r\n    socket.on(\"connect\", () => {\r\n      console.log(\"socket\", \"客户端连接建立\");\r\n      socket.on(\"enter\", (obj) => {\r\n        if (obj.error) {\r\n          Vue.prototype.$notify({\r\n            title: \"警告\",\r\n            message: \"昵称重复\",\r\n            type: \"warning\",\r\n          });\r\n          return;\r\n        }\r\n        if (obj.user === \"me\") {\r\n          this.isName = true;\r\n          this.nickName = obj.nickname;\r\n        }\r\n        // console.log(obj, \"enter\");\r\n        this.infoList.push(obj);\r\n      });\r\n      socket.on(\"leave\", (obj) => {\r\n        this.infoList.push(obj);\r\n        console.log(obj, \"leave\");\r\n      });\r\n      socket.on(\"receive\", (obj) => {\r\n        this.infoList.push(obj);\r\n        console.log(obj, \"obj\");\r\n      });\r\n    });\r\n\r\n  },\r\n  beforeDestroy() {\r\n    this.socket.close();\r\n  },\r\n\r\n  mounted() {},\r\n\r\n  methods: {\r\n    send() {\r\n      this.socket.emit(\"chat\", { msg: this.content, nickname: this.nickName });\r\n      this.content = \"\"\r\n    },\r\n    submitName() {\r\n      this.socket.emit(\"login\", { nickname: this.nameContent });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n  .blog-room--content {\r\n    display: flex\r\n    flex-direction: column\r\n    justify-content: space-around\r\n  }\r\n  .blog-room--info--wrap\r\n    display: flex\r\n    justify-content: center\r\n    align-items: center\r\n    & *\r\n      margin 2px 6px\r\n  .blog-room--info--wrap.left\r\n    align-items: center\r\n    justify-content: flex-start\r\n  .blog-room--info--wrap.right\r\n    flex-direction: row-reverse\r\n    justify-content: flex-start\r\n    align-items: center\r\n  .userClass\r\n    color: #fff\r\n    font-size 20px\r\n</style>\r\n"]}]}