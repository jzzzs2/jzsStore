{"remainingRequest":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\babel-loader\\lib\\index.js!D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\src\\components\\Form.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\src\\components\\Form.vue","mtime":1679713488513},{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\babel.config.js","mtime":1678865839779},{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":1678865247956},{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678865246950},{"path":"D:\\十字波\\五.vue框架\\练习\\23Vue20230315\\vue-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":1678865248335}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGZvcm1JbnB1dCBmcm9tICJAL2NvbmZpZy9mb3JtRGF0YXMuanMiOwppbXBvcnQgcnVsZXNNYXAgZnJvbSAiQC9jb25maWcvZm9ybVZhbGlkYXRlLmpzIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBydWxlRm9ybToge30sCiAgICAgIGltYWdlVXJsOiAiIgogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBmb3JtSW5wdXRzKCkgewogICAgICByZXR1cm4gZm9ybUlucHV0W3RoaXMudHlwZV07CiAgICB9LAogICAgcnVsZXMoKSB7CiAgICAgIHJldHVybiBydWxlc01hcFt0aGlzLnR5cGVdOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIHR5cGU6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5jbGVhckZvcm0oKTsKICAgIH0KICB9LAogIHByb3BzOiB7CiAgICB0eXBlOiB7CiAgICAgIHR5cGU6IFN0cmluZwogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGlmICh0aGlzLiRyb3V0ZS5uYW1lID09ICJteUluZm8iKSB7CiAgICAgIGNvbnNvbGUubG9nKCLlr7nmlbDmja7ov5vooYzlpITnkIYiKTsKICAgICAgY29uc29sZS5sb2codGhpcy5mb3JtSW5wdXRzKTsKICAgICAgbGV0IHNvdXJjZURhdGEgPSB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mbzsKICAgICAgY29uc29sZS5sb2coc291cmNlRGF0YSwgInNvdXJjZSIpOwogICAgICBsZXQgZmluYWxBcnIgPSBPYmplY3QuZW50cmllcyhzb3VyY2VEYXRhKS5maWx0ZXIoKFtrZXldKSA9PiB7CiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybUlucHV0cy5maW5kKGl0ZW0gPT4gewogICAgICAgICAgY29uc29sZS5sb2coaXRlbS5xdWVyeSwga2V5LCAidGVzdCIpOwogICAgICAgICAgcmV0dXJuIGl0ZW0ucXVlcnkgPT09IGtleTsKICAgICAgICB9KSAhPT0gdW5kZWZpbmVkOwogICAgICB9KTsKICAgICAgY29uc29sZS5sb2coZmluYWxBcnIsICJBcnIiKTsKICAgICAgbGV0IGZpbmFsT2JqID0gT2JqZWN0LmZyb21FbnRyaWVzKGZpbmFsQXJyKTsKICAgICAgY29uc29sZS5sb2coZmluYWxPYmosICJmaW5hbE9iaiIpOwogICAgICB0aGlzLnJ1bGVGb3JtID0gZmluYWxPYmo7CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgLy8gY29uc29sZS5sb2codGhpcy50eXBlLCJtb3VudGVkIik7CiAgfSwKICBtZXRob2RzOiB7CiAgICBjbGVhckZvcm0oKSB7CiAgICAgIHRoaXMuJHJlZnNbImVsRm9ybSJdLnJlc2V0RmllbGRzKCk7CiAgICB9LAogICAgaGFuZGxlQXZhdGFyU3VjY2VzcyhyZXMpIHsKICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICB0aGlzLnJ1bGVGb3JtLmF2YXRhciA9IHJlcy5kYXRhOwogICAgICAvLyB0aGlzLmltYWdlVXJsID0gcmVzLmRhdGE7CiAgICAgIC8vIHRoaXMuaW1hZ2VVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUucmF3KTsKICAgIH0sCgogICAgYmVmb3JlQXZhdGFyVXBsb2FkKGZpbGUpIHsKICAgICAgY29uc29sZS5sb2coZmlsZSk7CiAgICAgIGlmIChmaWxlLnNpemUgPiAyMCAqIDEwMjQgKiAxMDI0KSB7CiAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgIHRpdGxlOiAn6K2m5ZGKJywKICAgICAgICAgIG1lc3NhZ2U6ICfmlofku7bov4flpKcnLAogICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIGlmICghL2ltYWdlLy50ZXN0KGZpbGUudHlwZSkpIHsKICAgICAgICBjb25zb2xlLmxvZygidHlwZSBmaWxlIik7CiAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgIHRpdGxlOiAn6K2m5ZGKJywKICAgICAgICAgIG1lc3NhZ2U6ICfmlofku7bnsbvlnovkuI3lr7knLAogICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHJldHVybiB0cnVlOwogICAgICAvLyBjb25zdCBpc0pQRyA9IGZpbGUudHlwZSA9PT0gImltYWdlL2pwZWciOwogICAgICAvLyBjb25zdCBpc0x0Mk0gPSBmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDI7CgogICAgICAvLyBpZiAoIWlzSlBHKSB7CiAgICAgIC8vICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi5LiK5Lyg5aS05YOP5Zu+54mH5Y+q6IO95pivIEpQRyDmoLzlvI8hIik7CiAgICAgIC8vIH0KICAgICAgLy8gaWYgKCFpc0x0Mk0pIHsKICAgICAgLy8gICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuIrkvKDlpLTlg4/lm77niYflpKflsI/kuI3og73otoXov4cgMk1CISIpOwogICAgICAvLyB9CiAgICAgIC8vIHJldHVybiBpc0pQRyAmJiBpc0x0Mk07CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["formInput","rulesMap","data","ruleForm","imageUrl","computed","formInputs","type","rules","watch","clearForm","props","String","created","$route","name","console","log","sourceData","$store","state","userInfo","finalArr","Object","entries","filter","key","find","item","query","undefined","finalObj","fromEntries","mounted","methods","$refs","resetFields","handleAvatarSuccess","res","avatar","beforeAvatarUpload","file","size","$notify","title","message","test"],"sources":["src/components/Form.vue"],"sourcesContent":["<!--\r\n * @Descripttion: \r\n * @version: \r\n * @Author: sueRimn\r\n * @Date: 2023-03-16 16:53:49\r\n * @LastEditors: sueRimn\r\n * @LastEditTime: 2023-03-25 11:03:45\r\n-->\r\n<template>\r\n  <div>\r\n    <el-form ref=\"elForm\" :model=\"ruleForm\" label-width=\"90px\" :rules=\"rules\">\r\n      <el-form-item\r\n        :label=\"item.label\"\r\n        v-for=\"item in formInputs\"\r\n        :key=\"item.query\"\r\n        :prop=\"item.query\"\r\n        :roles=\"rules[item?.query]\"\r\n      >\r\n        <el-upload\r\n          v-if=\"item.type === 'avatar'\"\r\n          class=\"avatar-uploader\"\r\n          action=\"http://127.0.0.1:3000/upload/user\"\r\n          :show-file-list=\"false\"\r\n          :on-success=\"handleAvatarSuccess\"\r\n          :before-upload=\"beforeAvatarUpload\"\r\n          :headers=\"{ Authorization: `Bearer ${$store.state.token}` }\"\r\n          \r\n        >\r\n          <el-image\r\n            v-if=\"ruleForm[item?.query]\" :src=\"ruleForm[item?.query]\" class=\"avatar\"\r\n            style=\"width: 50px; height: 50px\"\r\n            fit=\"fit\"\r\n          ></el-image>\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n        </el-upload>\r\n        <el-input\r\n          v-model=\"ruleForm[item?.query]\"\r\n          :readonly=\"item.readOnly\"\r\n          :type=\"item.type\"\r\n          v-else\r\n        ></el-input>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport formInput from \"@/config/formDatas.js\";\r\nimport rulesMap from \"@/config/formValidate.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      ruleForm: {},\r\n      imageUrl: \"\",\r\n    };\r\n  },\r\n  computed: {\r\n    formInputs() {\r\n      return formInput[this.type];\r\n    },\r\n    rules() {\r\n      return rulesMap[this.type];\r\n    },\r\n  },\r\n  watch: {\r\n    type: function () {\r\n      this.clearForm();\r\n    },\r\n  },\r\n  props: {\r\n    type: {\r\n      type: String,\r\n    },\r\n  },\r\n  created() {\r\n    if (this.$route.name == \"myInfo\") {\r\n      console.log(\"对数据进行处理\");\r\n      console.log(this.formInputs);\r\n      let sourceData = this.$store.state.userInfo;\r\n      console.log(sourceData, \"source\");\r\n      let finalArr = \r\n        Object.entries(sourceData).filter(([key]) => {\r\n          return (\r\n            (this.formInputs.find((item) => {\r\n              console.log(item.query,key,\"test\");\r\n              return item.query === key\r\n            })!== undefined) \r\n          );\r\n        })\r\n      ;\r\n      console.log(finalArr,\"Arr\");\r\n      let finalObj = Object.fromEntries(finalArr)\r\n      console.log(finalObj, \"finalObj\");\r\n      this.ruleForm = finalObj\r\n    }\r\n  },\r\n  mounted() {\r\n    // console.log(this.type,\"mounted\");\r\n  },\r\n\r\n  methods: {\r\n    clearForm() {\r\n      this.$refs[\"elForm\"].resetFields();\r\n    },\r\n    handleAvatarSuccess(res) {\r\n      console.log(res.data);\r\n      this.ruleForm.avatar = res.data\r\n      // this.imageUrl = res.data;\r\n      // this.imageUrl = URL.createObjectURL(file.raw);\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      console.log(file);\r\n      if (file.size > 20 * 1024 * 1024) {\r\n        this.$notify({\r\n          title: '警告',\r\n          message: '文件过大',\r\n          type: 'warning'\r\n        });\r\n        return false\r\n      }\r\n      if (!/image/.test(file.type)) {\r\n        console.log(\"type file\");\r\n        this.$notify({\r\n          title: '警告',\r\n          message: '文件类型不对',\r\n          type: 'warning'\r\n        });\r\n        return false\r\n      }\r\n      return true\r\n      // const isJPG = file.type === \"image/jpeg\";\r\n      // const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      // if (!isJPG) {\r\n      //   this.$message.error(\"上传头像图片只能是 JPG 格式!\");\r\n      // }\r\n      // if (!isLt2M) {\r\n      //   this.$message.error(\"上传头像图片大小不能超过 2MB!\");\r\n      // }\r\n      // return isJPG && isLt2M;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>"],"mappings":"AA+CA,OAAAA,SAAA;AACA,OAAAC,QAAA;AACA;EACAC,KAAA;IACA;MACAC,QAAA;MACAC,QAAA;IACA;EACA;EACAC,QAAA;IACAC,WAAA;MACA,OAAAN,SAAA,MAAAO,IAAA;IACA;IACAC,MAAA;MACA,OAAAP,QAAA,MAAAM,IAAA;IACA;EACA;EACAE,KAAA;IACAF,IAAA,WAAAA,CAAA;MACA,KAAAG,SAAA;IACA;EACA;EACAC,KAAA;IACAJ,IAAA;MACAA,IAAA,EAAAK;IACA;EACA;EACAC,QAAA;IACA,SAAAC,MAAA,CAAAC,IAAA;MACAC,OAAA,CAAAC,GAAA;MACAD,OAAA,CAAAC,GAAA,MAAAX,UAAA;MACA,IAAAY,UAAA,QAAAC,MAAA,CAAAC,KAAA,CAAAC,QAAA;MACAL,OAAA,CAAAC,GAAA,CAAAC,UAAA;MACA,IAAAI,QAAA,GACAC,MAAA,CAAAC,OAAA,CAAAN,UAAA,EAAAO,MAAA,GAAAC,GAAA;QACA,OACA,KAAApB,UAAA,CAAAqB,IAAA,CAAAC,IAAA;UACAZ,OAAA,CAAAC,GAAA,CAAAW,IAAA,CAAAC,KAAA,EAAAH,GAAA;UACA,OAAAE,IAAA,CAAAC,KAAA,KAAAH,GAAA;QACA,OAAAI,SAAA;MAEA;MAEAd,OAAA,CAAAC,GAAA,CAAAK,QAAA;MACA,IAAAS,QAAA,GAAAR,MAAA,CAAAS,WAAA,CAAAV,QAAA;MACAN,OAAA,CAAAC,GAAA,CAAAc,QAAA;MACA,KAAA5B,QAAA,GAAA4B,QAAA;IACA;EACA;EACAE,QAAA;IACA;EAAA,CACA;EAEAC,OAAA;IACAxB,UAAA;MACA,KAAAyB,KAAA,WAAAC,WAAA;IACA;IACAC,oBAAAC,GAAA;MACAtB,OAAA,CAAAC,GAAA,CAAAqB,GAAA,CAAApC,IAAA;MACA,KAAAC,QAAA,CAAAoC,MAAA,GAAAD,GAAA,CAAApC,IAAA;MACA;MACA;IACA;;IACAsC,mBAAAC,IAAA;MACAzB,OAAA,CAAAC,GAAA,CAAAwB,IAAA;MACA,IAAAA,IAAA,CAAAC,IAAA;QACA,KAAAC,OAAA;UACAC,KAAA;UACAC,OAAA;UACAtC,IAAA;QACA;QACA;MACA;MACA,aAAAuC,IAAA,CAAAL,IAAA,CAAAlC,IAAA;QACAS,OAAA,CAAAC,GAAA;QACA,KAAA0B,OAAA;UACAC,KAAA;UACAC,OAAA;UACAtC,IAAA;QACA;QACA;MACA;MACA;MACA;MACA;;MAEA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;EACA;AACA"}]}