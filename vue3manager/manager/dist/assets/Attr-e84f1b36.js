import{c as K,g as q,_ as H,d as Q,u as R}from"./cate.vue_vue_type_script_setup_true_lang-b9cb86c6.js";import{d as W,k as h,K as X,B as Y,L as Z,g as s,I as ee,o as d,c as f,a as t,w as a,u as l,h as x,b as C,i as p,M as te,F as $,e as le,t as w,G as b}from"./index-af70c94f.js";const ae={key:0},ne={key:1},oe=["onClick"],de=W({__name:"Attr",setup(se){let i=K(),m=h(!1);X(()=>i.c3Id,(e,y)=>{i.c3Id&&g()});let o=Y({attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),V=h([]),O=()=>{_.value=!1,Object.assign(o,{attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),m.value=!0},D=e=>{_.value=!1,console.log(JSON.stringify(e),"str"),Object.assign(o,JSON.parse(JSON.stringify(e))),m.value=!0},E=()=>{o.attrValueList.push({valueName:"",isEdit:!0})},B=async e=>{(await Q(e.id)).code===200?(b({type:"success",message:"删除成功"}),g()):b({type:"error",message:"删除失败"})},P=e=>{e.valueName.trim().length!==0&&(e.isEdit=!1)},S=e=>{console.log(e,"xxx"),e&&e.focus()},F=e=>{e.isEdit=!0},N=()=>{_.value=!0,m.value=!1},_=h(!0),g=async()=>{let e=await q(i.c1Id,i.c2Id,i.c3Id);e.code===200&&(V.value=e.data)},U=e=>{o.attrValueList.splice(e,1)},j=async()=>{o.categoryId=i.c3Id;let e=await R(o);console.log(e,"resultxxxx"),e.code===200?(b({message:o.id?"修改成功":"添加成功",type:"success"}),g(),_.value=!0,m.value=!1):b({message:o.id?"修改失败":"添加失败",type:"error"})};return Z(()=>{i.$reset()}),(e,y)=>{const L=s("el-card"),r=s("el-button"),c=s("el-table-column"),J=s("el-tag"),M=s("el-popconfirm"),A=s("el-table"),I=s("el-input"),T=s("el-form-item"),z=s("el-form"),v=ee("has");return d(),f($,null,[t(L,null,{default:a(()=>[t(H,{abled:l(m)},null,8,["abled"])]),_:1}),t(L,null,{default:a(()=>[l(_)?(d(),f("div",ae,[x((d(),C(r,{icon:"Plus",type:"primary",disabled:!l(i).c3Id,onClick:l(O)},{default:a(()=>[p(" 添加属性 ")]),_:1},8,["disabled","onClick"])),[[v,"btn.Attr.add"]]),t(A,{data:l(V),style:te([{width:"100%"},{marginTop:"8px"}]),border:""},{default:a(()=>[t(c,{label:"序号",width:"120",align:"center",type:"index"}),t(c,{label:"属性名称",width:"220",align:"center",prop:"attrName"}),t(c,{label:"属性值名称"},{default:a(({row:n,$index:k})=>[(d(!0),f($,null,le(n.attrValueList,(u,G)=>(d(),C(J,{class:"ml-2",type:"success",key:G,style:{marginLeft:"4px"}},{default:a(()=>[p(w(u.valueName),1)]),_:2},1024))),128))]),_:1}),t(c,{label:"操作",width:"220",align:"center"},{default:a(({row:n,$index:k})=>[x(t(r,{icon:"Edit",type:"primary",onClick:u=>l(D)(n)},null,8,["onClick"]),[[v,"btn.Attr.update"]]),t(M,{title:"真的要删除我么",onConfirm:u=>l(B)(n),width:"170px"},{reference:a(()=>[x(t(r,{icon:"Delete",type:"primary"},null,512),[[v,"btn.Attr.remove"]])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])])):(d(),f("div",ne,[t(z,null,{default:a(()=>[t(T,{label:"属性名称"},{default:a(()=>[t(I,{style:{width:"300px"},placeholder:"请输入属性名称",modelValue:l(o).attrName,"onUpdate:modelValue":y[0]||(y[0]=n=>l(o).attrName=n)},null,8,["modelValue"])]),_:1})]),_:1}),t(r,{icon:"Plus",type:"primary",disabled:!l(o).attrName.trim(),onClick:l(E)},{default:a(()=>[p(" 添加属性值 ")]),_:1},8,["disabled","onClick"]),t(r,{type:"primary",onClick:l(N)},{default:a(()=>[p("取消")]),_:1},8,["onClick"]),t(A,{data:l(o).attrValueList,style:{width:"100%",margin:"10px 0"},border:""},{default:a(()=>[t(c,{type:"index",label:"序号",width:"180"}),t(c,{label:"属性值名称"},{default:a(({row:n,$index:k})=>[n.isEdit?(d(),C(I,{key:0,modelValue:n.valueName,"onUpdate:modelValue":u=>n.valueName=u,onBlur:u=>l(P)(n),ref:l(S)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(d(),f("div",{key:1,onClick:u=>l(F)(n)},w(n.valueName),9,oe))]),_:1}),t(c,{label:"属性值操作"},{default:a(({$index:n})=>[t(r,{icon:"DeleteFilled",type:"info",onClick:k=>l(U)(n)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),t(r,{type:"primary",disabled:!(l(o).attrValueList.length>0),onClick:l(j)},{default:a(()=>[p(" 保存 ")]),_:1},8,["disabled","onClick"]),t(r,{type:"primary",onClick:l(N)},{default:a(()=>[p("取消")]),_:1},8,["onClick"])]))]),_:1})],64)}}});export{de as default};
