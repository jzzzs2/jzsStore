import{H as b,d as Y,k as p,B as z,l as Z,g as s,I as ee,o as y,c as T,a,w as r,h as U,b as w,u as e,i as V,m as B,J as N,F as ae,G as _,p as le}from"./index-af70c94f.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";const oe=(u,i)=>b.get(`/admin/product/baseTrademark/${u}/${i}`),re=u=>u.id?b.put("/admin/product/baseTrademark/update",u):b.post("/admin/product/baseTrademark/save",u),ne=u=>b.delete(`${"/admin/product/baseTrademark/remove/"+u}`),se=["src"],de=["src"],ie={class:"dialog-footer"},ue=Y({__name:"Trade",setup(u){let i=p(1),g=p(3),h=p(0),k=p([]),c=p(!1),t=z({tmName:"",logoUrl:""}),m=p(),E=z({tmName:[{required:!0,trigger:"blur",validator:(l,n,d)=>{n.length<=2?d(new Error("品牌名字长度要大于2哦")):d()}}],logoUrl:[{required:!0,validator:(l,n,d)=>{if(!n){d(new Error("请先选择图片"));return}d()}}]}),S=l=>l.type.includes("image")?l.size<1024*1024*4?!0:(_({message:"文件大小不能超过4MB",type:"error"}),!1):(_({message:"文件需要是图片类型",type:"error"}),!1),$=l=>{t.logoUrl=l.data},f=async()=>{let l=await oe(i.value,g.value);l.code===200&&(h.value=l.data.total,k.value=l.data.records)},D=async()=>{i.value=1,f()};Z(async()=>{f()});let G=()=>{c.value=!0,t.id="",t.tmName="",t.logoUrl="",m.value.clearValidate("tmName"),m.value.clearValidate("logoUrl")},P=()=>{c.value=!1},q=async()=>{await m.value.validate(),(await re(t)).code===200?(_({message:t.id?"修改成功":"添加成功",type:"success"}),c.value=!1,f()):_({message:t.id?"修改失败":"添加失败",type:"error"})},L=async l=>{c.value=!0,t.id=l.id,t.tmName=l.tmName,t.logoUrl=l.logoUrl,le(()=>{m.value.clearValidate("tmName"),m.value.clearValidate("logoUrl")})},M=async l=>{(await ne(l)).code===200?(_({message:"删除成功",type:"success"}),k.value.length<2&&(i.value-=1),f()):_({message:"删除失败",type:"error"})};return(l,n)=>{const d=s("el-button"),v=s("el-table-column"),A=s("el-popconfirm"),F=s("el-table"),I=s("el-pagination"),R=s("el-card"),j=s("el-input"),x=s("el-form-item"),H=s("Plus"),J=s("el-icon"),O=s("el-upload"),K=s("el-form"),Q=s("el-dialog"),C=ee("has");return y(),T(ae,null,[a(R,{class:"box-card"},{default:r(()=>[U((y(),w(d,{type:"primary",icon:"Plus",onClick:e(G)},{default:r(()=>[V("添加品牌")]),_:1},8,["onClick"])),[[C,"btn.Trademark.add"]]),a(F,{border:"",data:e(k)},{default:r(()=>[a(v,{label:"序号",width:"100px",align:"center",type:"index"}),a(v,{label:"商品名称",prop:"tmName",align:"center"}),a(v,{label:"商品Logo",align:"center"},{default:r(({row:o,$index:W})=>[B("img",{src:o.logoUrl,alt:"图片不见惹",style:{width:"120px",height:"120px"}},null,8,se)]),_:1}),a(v,{label:"商品操作",align:"center"},{default:r(({row:o,$index:W})=>[U(a(d,{type:"primary",icon:"Edit",size:"small",onClick:X=>e(L)(o)},null,8,["onClick"]),[[C,"btn.Trademark.update"]]),a(A,{title:"真的要这样么?",onConfirm:X=>e(M)(o.id)},{reference:r(()=>[U(a(d,{type:"primary",icon:"Delete",size:"small"},null,512),[[C,"btn.Trademark.remove"]])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),a(I,{"current-page":e(i),"onUpdate:currentPage":n[0]||(n[0]=o=>N(i)?i.value=o:i=o),"page-size":e(g),"onUpdate:pageSize":n[1]||(n[1]=o=>N(g)?g.value=o:g=o),"page-sizes":[3,5,7],small:!1,background:!0,layout:"prev, pager, next, jumper,->,sizes, total",total:e(h),onCurrentChange:e(f),onSizeChange:e(D)},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])]),_:1}),a(Q,{modelValue:e(c),"onUpdate:modelValue":n[3]||(n[3]=o=>N(c)?c.value=o:c=o),title:e(t).id?"修改品牌":"添加品牌"},{footer:r(()=>[B("span",ie,[a(d,{onClick:e(P)},{default:r(()=>[V("取消")]),_:1},8,["onClick"]),a(d,{type:"primary",onClick:e(q)},{default:r(()=>[V("确定")]),_:1},8,["onClick"])])]),default:r(()=>[a(K,{style:{width:"70%"},model:e(t),rules:e(E),ref_key:"form",ref:m},{default:r(()=>[a(x,{label:"品牌名称",prop:"tmName"},{default:r(()=>[a(j,{modelValue:e(t).tmName,"onUpdate:modelValue":n[2]||(n[2]=o=>e(t).tmName=o)},null,8,["modelValue"])]),_:1}),a(x,{label:"品牌Logo",prop:"logoUrl"},{default:r(()=>[a(O,{class:"avatar-uploader",action:"api/admin/product/fileUpload","show-file-list":!1,"before-upload":e(S),"on-success":e($)},{default:r(()=>[e(t).logoUrl?(y(),T("img",{key:0,src:e(t).logoUrl,class:"avatar"},null,8,de)):(y(),w(J,{key:1,class:"avatar-uploader-icon"},{default:r(()=>[a(H)]),_:1}))]),_:1},8,["before-upload","on-success"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}});const ge=te(ue,[["__scopeId","data-v-f78e79ea"]]);export{ge as default};
