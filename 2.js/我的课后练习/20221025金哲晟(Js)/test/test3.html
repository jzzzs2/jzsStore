<!--
 * @Descripttion: 
 * @version: 
 * @Author: sueRimn
 * @Date: 2022-10-25 19:46:39
 * @LastEditors: sueRimn
 * @LastEditTime: 2022-10-25 20:35:51
-->
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>代理 proxy</title>
</head>

<body>
  <script>
    // let o = {
    //   age: 22,
    //   name: "jzs"
    // }
    // let temp = 22;
    // Object.defineProperty(o, "age", {
    //   set (newValue) {
    //     temp = newValue;
    //   },
    //   get () {
    //     return temp;
    //   }
    // });
    // console.log(o.age);
    // console.log(o);
    //
    // let proxy = new Proxy(o, {
    //   get (target, key, p) {
    //     // console.log(target, key, p);
    //     // target[key] = 999;
    //     // return target[key];
    //     return "666"
    //   },
    //   set (target, key, value) {
    //     console.log(target, key, value);
    //     // target[key] = value * 2;
    //   }
    // })
    // console.log(proxy);
    // console.log(proxy.age = 50);
    // console.log(proxy);
    // console.log(o);
    // let proxy = new Proxy(o, {
    //   set (target, prop, value) {
    //     console.log(`目标对象是${target} 属性是${prop} 修改的值是 ${value}`);
    //   },
    //   get (target, prop, proxy) {
    //     console.log(`目标对象是 ${target} 属性是${prop} 代理对象是`);
    //     console.log(proxy);
    //   }
    // })
    // console.log(proxy.age);
    // proxy.age = 22;
    // console.log(proxy);
    let obj = {
      name: "jzs",
      _name: "亚托克金"
    }
    function toProxy(obj) {
      return new Proxy(obj, {
        set(target, key, value) {
          target[key] = value;
        },
        get(target, key, proxy) {
          if (key in target && key[0] !== "_") {
            return target[key];
          } else {
            throw new ReferenceError(`无法获取到${key}捏`);
          }
        },
        apply(target, ctx, args) {
          console.log(target, ctx, args);
          target.call(ctx);
        }
      })
    }
    // let proxy = toProxy(obj);
    // proxy.name = "jzsSama";
    // console.log(proxy.name);
    // proxy._name = "亚托克经";
    let funcProxy = toProxy(function () {
      console.log("我是被封装的函数" + this.name);
    })
    funcProxy.call(obj,2,5,6);
  </script>
</body>

</html>