<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>旋转木马捏</title>
  <style>
    * {
      margin: 0;
      padding: 0;
    }

    img {
      display: block;
    }

    html,
    body {
      height: 100%;
    }

    ul {
      list-style: none;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .slider-wrap {
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .pic-list {
      position: relative;
      width: 1200px;
      height: 600px;
    }

    .pic-list li {
      position: absolute;
      box-shadow: 0 0 4px #222;
    }

    .pic-list li img {
      width: 100%;
      height: 100%;
    }

    .btn-wrap span {
      position: absolute;
      top: -150px;
      bottom: 0;
      margin: auto;
      z-index: 2;
      width: 120px;
      height: 240px;
      line-height: 240px;
      text-align: center;
      font-size: 80px;
      background-color: rgba(0, 0, 0, .4);
      cursor: pointer;
      border-radius: 8px;
    }

    .btn-wrap span.prev {
      left: -120px;
    }

    .btn-wrap span.next {
      right: -120px;
    }
  </style>
</head>

<body>
  <div class="slider-wrap">
    <ul class="pic-list">
      <li><img src="img/1.jpg" alt="miku"></li>
      <li><img src="img/2.jpg" alt="miku"></li>
      <li><img src="img/3.jpg" alt="miku"></li>
      <li><img src="img/4.jpg" alt="miku"></li>
      <li><img src="img/6.jpg" alt="miku"></li>
    </ul>
    <div class="btn-wrap">
      <span class="prev"> &lt; </span>
      <span class="next"> &gt; </span>
    </div>
  </div>
  <script src="./my.js"></script>
  <script>
    var aLi = $$("li");
    var oBtn = $(".btn-wrap");
    var data = [
      {

        zIndex: 0,
        top: -120,
        left: 80,
        width: 400,
        height: 250,
      },
      {

        zIndex: 1,
        top: 0,
        left: 0,
        width: 600,
        height: 375,
      },
      {

        zIndex: 2,
        top: 80,
        left: 200,
        width: 800,
        height: 500,
      },
      {

        zIndex: 1,
        top: 0,
        left: 600,
        width: 600,
        height: 375,
      },
      {

        zIndex: 0,
        top: -120,
        left: 720,
        width: 400,
        height: 250,
      }
    ];
    var objFunc = {
      prev: function () {
        modifyData.unshift(modifyData.pop());
        translate(aLi, modifyData);
      },
      next: function () {
        modifyData.push(modifyData.shift());
        translate(aLi, modifyData);
      }
    }
    var modifyData;
    function formatData(arr) {
      return arr.map(function (curr, i, arr) {
        for (key in curr) {
          if (key !== "zIndex") {
            curr[key] = curr[key] + "px";
          }
        }
        return curr;
      })
    }
    modifyData = formatData(data);
    function translate(doms, data) {
      for (var i = 0; i < doms.length; i++) {
        animate(doms[i], data[i]);
      }
    }
    translate(aLi, modifyData);
    oBtn.addEventListener("click", function (e) {
      if (e.target.tagName === "SPAN") {
        objFunc[e.target.className]();
      }
    })
    function animate(ele, json, callback) {
      clearInterval(ele.intervalOut);
      ele.intervalOut = setInterval(function () {
        var toggle = true;
        for (var key in json) {
          if (key === "zIndex") {
            ele.style[key] = json[key];
            continue;
          }
          var startValue = parseInt(getStyle(ele, key));
          var endValue = parseInt(json[key]);
          var speed = (endValue - startValue) / 10;
          speed = speed > 0 ? Math.ceil(speed) : Math.floor(speed);
          console.log(speed, "speed");
          console.log(ele.style[key], "ele");
          ele.style[key] = startValue + speed + "px";
          if (parseInt(ele.style[key]) !== endValue) {
            toggle = false;
          }
        }
        if (toggle) {
          clearInterval(ele.intervalOut);
          callback && callback();
        }
      }, 1000 / 60)
    }
  </script>
</body>

</html>